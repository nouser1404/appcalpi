<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Plan de d√©bit panneaux 2D ‚Äì optimisation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- FORMULAIRE -->
  <div class="card" id="formCard">
    <h1>Plan de d√©bit panneaux 2D ‚Äì Optimisation</h1>
    <p class="muted">
      Saisis tes pi√®ces de panneaux (longueur √ó largeur, quantit√©) et les dimensions de tes panneaux bruts
      (par ex. 2800 √ó 2070 mm). L'application calcule un calepinage 2D simplifi√© pour limiter les chutes,
      num√©rote les pi√®ces et g√©n√®re un sch√©ma par panneau, exportable en PDF.
    </p>

    <form id="calpinageForm">

      <h2>Pi√®ces de panneaux √† d√©couper</h2>
      <p class="muted">
        Chaque ligne correspond √† une pi√®ce de panneau (c√¥t√©, √©tag√®re, fa√ßade, etc.).
        Les longueurs et largeurs sont en millim√®tres.
      </p>

      <div id="piecesContainer">
        <!-- Ligne de pi√®ce par d√©faut -->
        <div class="piece-row">
          <div class="piece-header">
            <span class="piece-title">Pi√®ce 1</span>
            <button
              type="button"
              class="piece-remove-btn"
              aria-label="Supprimer la pi√®ce"
              title="Supprimer la pi√®ce"
            >
              üóëÔ∏è
            </button>
          </div>
          <div class="grid piece-grid">
            <div>
              <label>Nom de la pi√®ce</label>
              <input type="text" class="piece-name" placeholder="Pi√®ce 1 (ex : C√¥t√© armoire)">
            </div>
            <div>
              <label>Longueur (sens principal) <span class="unit">(mm)</span></label>
              <input type="number" class="piece-length" value="800" min="1" required>
            </div>
            <div>
              <label>Largeur <span class="unit">(mm)</span></label>
              <input type="number" class="piece-width" value="400" min="1" required>
            </div>
            <div>
              <label>Quantit√©</label>
              <input type="number" class="piece-qty" value="2" min="1" required>
            </div>
          </div>
        </div>
      </div>

      <div class="actions">
        <button type="button" id="addPieceBtn" class="secondary">Ajouter une pi√®ce</button>
      </div>

      <hr style="margin:1rem 0; border:none; border-top:1px solid #ddd;">

      <h2>Panneaux bruts</h2>

      <div class="grid">
        <div>
          <label for="stockLength">Longueur du panneau (sens principal) <span class="unit">(mm)</span></label>
          <input id="stockLength" type="number" value="2800" min="1" required>
        </div>

        <div>
          <label for="stockWidth">Largeur du panneau <span class="unit">(mm)</span></label>
          <input id="stockWidth" type="number" value="2070" min="1" required>
        </div>

        <div>
          <label for="kerf">
            Trait de scie / jeu entre pi√®ces <span class="unit">(mm)</span>
          </label>
          <input id="kerf" type="number" value="3" min="0" required>
        </div>
      </div>

      <p class="muted">
        Les pi√®ces peuvent √™tre tourn√©es de <strong>90¬∞</strong> si cela permet de mieux remplir le panneau
        (l'orientation est choisie automatiquement).
      </p>

      <div class="actions">
        <button type="submit">Calculer</button>
        <button type="button" class="secondary" onclick="window.print()">
          Exporter en PDF
        </button>
      </div>

      <div id="error" class="error"></div>
    </form>
  </div>

  <!-- R√âSULTATS -->
  <div class="card" id="resultsCard" style="display:none;">
    <h2>R√©sultats ‚Äì Plan de d√©bit panneaux 2D</h2>
    <div id="summary"></div>

    <div id="cutListDetailed"></div>

    <h3>Calepinage des panneaux</h3>
    <p class="muted">
      Chaque bande repr√©sente un panneau brut. Les rectangles repr√©sentent les pi√®ces plac√©es,
      avec leur num√©ro (#N). L'ordre de placement peut servir de guide de d√©coupe.
    </p>
    <div class="drawing-wrapper">
      <svg id="boardsSvg" class="boards-layout-svg" preserveAspectRatio="xMidYMid meet"></svg>
    </div>

    <div id="optimization"></div>
  </div>

  <script src="calpinage.js" defer></script>
</body>
</html>
